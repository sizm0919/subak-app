{"ast":null,"code":"$(document).on('turbolinks:load', function () {\n  // PAY.JPの公開鍵をセットします。\n  Payjp.setPublicKey('pk_test_d7baa143fb5c93a1c0c3b411'); //formのsubmitを止めるために, クレジットカード登録のformを定義します。\n\n  var form = $(\".form\");\n  $(\"#charge-form\").click(function () {\n    // submitが完了する前に、formを止めます。\n    form.find(\"input[type=submit]\").prop(\"disabled\", true); // submitを止められたので、PAY.JPの登録に必要な処理をします。\n    // formで入力された、カード情報を取得します。\n\n    var card = {\n      number: $(\"#card_number\").val(),\n      cvc: $(\"#cvc\").val(),\n      exp_month: $(\"#exp_month\").val(),\n      exp_year: $(\"#exp_year\").val()\n    }; // PAYJPに登録するためのトークン作成\n\n    Payjp.createToken(card, function (status, response) {\n      if (response.error) {\n        // エラーがある場合処理しない。\n        form.find('.payment-errors').text(response.error.message);\n        form.find('button').prop('disabled', false);\n      } else {\n        // エラーなく問題なく進めた場合\n        // formで取得したカード情報を削除して、Appにカード情報を残さない。\n        $(\"#card_number\").removeAttr(\"name\");\n        $(\"#cvc\").removeAttr(\"name\");\n        $(\"#exp_month\").removeAttr(\"name\");\n        $(\"#exp_year\").removeAttr(\"name\");\n        var token = response.id;\n        form.append($('<input type=\"hidden\" name=\"payjpToken\" />').val(token));\n        form.get(0).submit();\n      }\n\n      ;\n    });\n  });\n});","map":{"version":3,"sources":["C:/Users/suzum/subak-app-sample/app/javascript/packs/payjp.js"],"names":["$","document","on","Payjp","setPublicKey","form","click","find","prop","card","number","val","cvc","exp_month","exp_year","createToken","status","response","error","text","message","removeAttr","token","id","append","get","submit"],"mappings":"AAAAA,CAAC,CAACC,QAAD,CAAD,CAAYC,EAAZ,CAAe,iBAAf,EAAiC,YAAU;AACvC;AACAC,EAAAA,KAAK,CAACC,YAAN,CAAmB,kCAAnB,EAFuC,CAIvC;;AACA,MAAIC,IAAI,GAAGL,CAAC,CAAC,OAAD,CAAZ;AAEAA,EAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBM,KAAlB,CAAwB,YAAW;AACjC;AACAD,IAAAA,IAAI,CAACE,IAAL,CAAU,oBAAV,EAAgCC,IAAhC,CAAqC,UAArC,EAAiD,IAAjD,EAFiC,CAGjC;AAEA;;AACA,QAAIC,IAAI,GAAG;AACTC,MAAAA,MAAM,EAAEV,CAAC,CAAC,cAAD,CAAD,CAAkBW,GAAlB,EADC;AAETC,MAAAA,GAAG,EAAEZ,CAAC,CAAC,MAAD,CAAD,CAAUW,GAAV,EAFI;AAGTE,MAAAA,SAAS,EAAEb,CAAC,CAAC,YAAD,CAAD,CAAgBW,GAAhB,EAHF;AAITG,MAAAA,QAAQ,EAAEd,CAAC,CAAC,WAAD,CAAD,CAAeW,GAAf;AAJD,KAAX,CANiC,CAajC;;AACAR,IAAAA,KAAK,CAACY,WAAN,CAAkBN,IAAlB,EAAwB,UAASO,MAAT,EAAiBC,QAAjB,EAA2B;AACjD,UAAIA,QAAQ,CAACC,KAAb,EAAmB;AACjB;AACAb,QAAAA,IAAI,CAACE,IAAL,CAAU,iBAAV,EAA6BY,IAA7B,CAAkCF,QAAQ,CAACC,KAAT,CAAeE,OAAjD;AACAf,QAAAA,IAAI,CAACE,IAAL,CAAU,QAAV,EAAoBC,IAApB,CAAyB,UAAzB,EAAqC,KAArC;AACD,OAJD,MAKK;AACH;AACA;AACAR,QAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBqB,UAAlB,CAA6B,MAA7B;AACArB,QAAAA,CAAC,CAAC,MAAD,CAAD,CAAUqB,UAAV,CAAqB,MAArB;AACArB,QAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBqB,UAAhB,CAA2B,MAA3B;AACArB,QAAAA,CAAC,CAAC,WAAD,CAAD,CAAeqB,UAAf,CAA0B,MAA1B;AACA,YAAIC,KAAK,GAAGL,QAAQ,CAACM,EAArB;AACAlB,QAAAA,IAAI,CAACmB,MAAL,CAAYxB,CAAC,CAAC,2CAAD,CAAD,CAA+CW,GAA/C,CAAmDW,KAAnD,CAAZ;AACAjB,QAAAA,IAAI,CAACoB,GAAL,CAAS,CAAT,EAAYC,MAAZ;AACD;;AAAA;AACF,KAjBD;AAkBD,GAhCD;AAiCD,CAxCH","sourcesContent":["$(document).on('turbolinks:load',function(){\n    // PAY.JPの公開鍵をセットします。\n    Payjp.setPublicKey('pk_test_d7baa143fb5c93a1c0c3b411');\n  \n    //formのsubmitを止めるために, クレジットカード登録のformを定義します。\n    var form = $(\".form\");\n  \n    $(\"#charge-form\").click(function() {\n      // submitが完了する前に、formを止めます。\n      form.find(\"input[type=submit]\").prop(\"disabled\", true);\n      // submitを止められたので、PAY.JPの登録に必要な処理をします。\n  \n      // formで入力された、カード情報を取得します。\n      var card = {\n        number: $(\"#card_number\").val(),\n        cvc: $(\"#cvc\").val(),\n        exp_month: $(\"#exp_month\").val(),\n        exp_year: $(\"#exp_year\").val(),\n      };\n  \n      // PAYJPに登録するためのトークン作成\n      Payjp.createToken(card, function(status, response) {\n        if (response.error){\n          // エラーがある場合処理しない。\n          form.find('.payment-errors').text(response.error.message);\n          form.find('button').prop('disabled', false);\n        }   \n        else {\n          // エラーなく問題なく進めた場合\n          // formで取得したカード情報を削除して、Appにカード情報を残さない。\n          $(\"#card_number\").removeAttr(\"name\");\n          $(\"#cvc\").removeAttr(\"name\");\n          $(\"#exp_month\").removeAttr(\"name\");\n          $(\"#exp_year\").removeAttr(\"name\");\n          var token = response.id;\n          form.append($('<input type=\"hidden\" name=\"payjpToken\" />').val(token));\n          form.get(0).submit();\n        };\n      });\n    });\n  });"]},"metadata":{},"sourceType":"module"}